<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.billionsfinance.bas.dao.DataCheckDao" >
 	
 	 <resultMap id="DataCheckMap" type="java.util.HashMap">
  		<result column="CLASSFY" property="classfy" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="FKBJ" property="fkbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SHBJ" property="shbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="YQBJ" property="yqbj" jdbcType="VARCHAR" javaType="java.lang.String" />
  		<result column="WDQBJ" property="wdqbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CY" property="cy" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="BELONG" property="belong" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="GUARANTEEPARTY" property="guaranteeparty" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DQBJ" property="dqbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DQLX" property="dqlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SHLX" property="shlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="YQLX" property="yqlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="BJCY" property="bjcy" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="LXCY" property="lxcy" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SFDQ" property="sfdq" jdbcType="VARCHAR" javaType="java.lang.String" />
  		<result column="DCBJ" property="dcbj" jdbcType="VARCHAR" javaType="java.lang.String" />
  		<result column="DCLX" property="dclx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="RANSOMSUM" property="ransomsum" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SRF" property="srf" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="ZRBJ" property="zrbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="ZRLX" property="zrlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SHBD" property="shbd" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SYLJBJ" property="syljbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="SYLJLX" property="syljlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DYBJ" property="dybj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DYLX" property="dylx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DYLJBJ" property="dyljbj" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="DYLJLX" property="dyljlx" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="CONTRACTCOUNT" property="contractCount" jdbcType="VARCHAR" javaType="java.lang.String" />
 		<result column="MONEYCOUNT" property="moneyCount" jdbcType="VARCHAR" javaType="java.lang.String" />
 	</resultMap>
	
	<select id="queryDataCheckTableMenuOne" resultMap="DataCheckMap">
		SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,FKBJ-NVL(SHBJ,0)-NVL(YQBJ,0)-NVL(WDQBJ,0) CY FROM (
				SELECT T.CLASSFY CLASSFY,SUM(CASE WHEN T.DATASOURCE='base' THEN T.PAYPRINCIPALAMT END) FKBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='undue' THEN T.PAYPRINCIPALAMT END) WDQBJ
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '01' GROUP BY T.CLASSFY ORDER BY T.CLASSFY) V
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 			  
	</select>
	
	<select id="queryDataCheckTableMenuTwo" resultMap="DataCheckMap">
		  SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,DQBJ-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,DQLX-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '02' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuThree" resultMap="DataCheckMap">
		  SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,NVL(DQBJ,0)-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,NVL(DQLX,0)-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '03' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuFour" resultMap="DataCheckMap">
		  SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(DCBJ,0) BJCY,NVL(DQLX,0)+NVL(WDQLX,0)-NVL(DCLX,0) LXCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) DCBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) DCLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '04' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuFive" resultMap="DataCheckMap">
		 SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(RANSOMSUM,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) RANSOMSUM
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '05' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY ) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuNine" resultMap="DataCheckMap">
		 SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(ZRBJ,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.BELONG SRF,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) ZRBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) ZRLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '09' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.BELONG) V ORDER BY V.SFDQ,V.SRF
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuTwelve" resultMap="DataCheckMap">
		 SELECT * FROM (
			SELECT A.*,ROWNUM RN FROM (
				SELECT V.*,NVL(SYLJBJ,0)+NVL(DYBJ,0)-NVL(DYLJBJ,0) BJCY,
				NVL(SYLJLX,0)+NVL(DYLX,0)-NVL(DYLJLX,0) LXCY FROM (
				SELECT DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表') SHBD,T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYPRINCIPALAMT END) SYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYPRINCIPALAMT END) DYBJ,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYPRINCIPALAMT END) DYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYINTEAMT END) SYLJLX,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYINTEAMT END) DYLX,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYINTEAMT END) DYLJLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE IN ('02','99','12') AND T.DATASOURCE IN ('pay','actualpay')
				GROUP BY DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表'),T.BELONG,T.GUARANTEEPARTY) V ORDER BY V.SHBD,V.BELONG,V.GUARANTEEPARTY
				)   A WHERE ROWNUM &lt;= #{endpoint} 
			  ) WHERE RN &gt;= #{startpoint} 
	</select>
	
	<select id="queryDataCheckTableMenuOneCount" resultMap="DataCheckMap">
		SELECT COUNT(*) CONTRACTCOUNT FROM (
			SELECT V.*,FKBJ-NVL(SHBJ,0)-NVL(YQBJ,0)-NVL(WDQBJ,0) CY FROM (
			SELECT T.CLASSFY CLASSFY,SUM(CASE WHEN T.DATASOURCE='base' THEN T.PAYPRINCIPALAMT END) FKBJ,
			SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
			SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
			SUM(CASE WHEN T.DATASOURCE='undue' THEN T.PAYPRINCIPALAMT END) WDQBJ
			FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '01' GROUP BY T.CLASSFY ORDER BY T.CLASSFY) V
		) 
	</select>
	
	<select id="queryDataCheckTableMenuTwoCount" resultMap="DataCheckMap">
		  SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,DQBJ-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,DQLX-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '02' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
		  )
	</select>
	
	<select id="queryDataCheckTableMenuThreeCount" resultMap="DataCheckMap">
		  SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,NVL(DQBJ,0)-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,NVL(DQLX,0)-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '03' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
		  ) 
	</select>
	
	<select id="queryDataCheckTableMenuFourCount" resultMap="DataCheckMap">
		  SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(DCBJ,0) BJCY,NVL(DQLX,0)+NVL(WDQLX,0)-NVL(DCLX,0) LXCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) DCBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) DCLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '04' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
		  )
	</select>
	
	<select id="queryDataCheckTableMenuFiveCount" resultMap="DataCheckMap">
		 SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(RANSOMSUM,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) RANSOMSUM
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '05' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY ) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
		  )
	</select>
	
	<select id="queryDataCheckTableMenuNineCount" resultMap="DataCheckMap">
		SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(ZRBJ,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.BELONG SRF,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) ZRBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) ZRLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '09' 
				GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.BELONG) V ORDER BY V.SFDQ,V.SRF
		  )
	</select>
	
	<select id="queryDataCheckTableMenuTwelveCount" resultMap="DataCheckMap">
		 SELECT COUNT(*) CONTRACTCOUNT FROM (
				SELECT V.*,NVL(SYLJBJ,0)+NVL(DYBJ,0)-NVL(DYLJBJ,0) BJCY,
				NVL(SYLJLX,0)+NVL(DYLX,0)-NVL(DYLJLX,0) LXCY FROM (
				SELECT DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表') SHBD,T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYPRINCIPALAMT END) SYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYPRINCIPALAMT END) DYBJ,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYPRINCIPALAMT END) DYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYINTEAMT END) SYLJLX,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYINTEAMT END) DYLX,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYINTEAMT END) DYLJLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE IN ('02','99','12') AND T.DATASOURCE IN ('pay','actualpay')
				GROUP BY DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表'),T.BELONG,T.GUARANTEEPARTY) V ORDER BY V.SHBD,V.BELONG,V.GUARANTEEPARTY
		   )
	</select>
	
	<select id="queryDataCheckTableMenuOneFindAll" resultMap="DataCheckMap">
		 SELECT V.*,FKBJ-NVL(SHBJ,0)-NVL(YQBJ,0)-NVL(WDQBJ,0) CY FROM (
				SELECT T.CLASSFY CLASSFY,SUM(CASE WHEN T.DATASOURCE='base' THEN T.PAYPRINCIPALAMT END) FKBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='undue' THEN T.PAYPRINCIPALAMT END) WDQBJ
		   FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '01' GROUP BY T.CLASSFY ORDER BY T.CLASSFY) V
	</select>
	
	<select id="queryDataCheckTableMenuTwoFindAll" resultMap="DataCheckMap">
		 SELECT V.*,DQBJ-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,DQLX-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
		   FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '02' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
	</select>
	
	<select id="queryDataCheckTableMenuThreeFindAll" resultMap="DataCheckMap">
		 SELECT V.*,NVL(DQBJ,0)-NVL(SHBJ,0)-NVL(YQBJ,0) BJCY,NVL(DQLX,0)-NVL(SHLX,0)-NVL(YQLX,0) LXCY FROM (
				SELECT T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYPRINCIPALAMT END) SHBJ,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYPRINCIPALAMT END) YQBJ,
				SUM(CASE WHEN T.DATASOURCE='pay' THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN T.DATASOURCE='actualpay' THEN T.PAYINTEAMT END) SHLX,
				SUM(CASE WHEN T.DATASOURCE='overdue' THEN T.PAYINTEAMT END) YQLX
		   FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '03' GROUP BY T.BELONG,T.GUARANTEEPARTY ORDER BY T.BELONG,T.GUARANTEEPARTY) V
	</select>
	
	<select id="queryDataCheckTableMenuFourFindAll" resultMap="DataCheckMap">
		 SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(DCBJ,0) BJCY,NVL(DQLX,0)+NVL(WDQLX,0)-NVL(DCLX,0) LXCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) DCBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) DCLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '04' 
		  GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
	</select>
	
	<select id="queryDataCheckTableMenuFiveFindAll" resultMap="DataCheckMap">
		 SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(RANSOMSUM,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) RANSOMSUM
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '05' 
	   GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.GUARANTEEPARTY ) V ORDER BY V.SFDQ,V.GUARANTEEPARTY
	</select>
	
	<select id="queryDataCheckTableMenuNineFindAll" resultMap="DataCheckMap">
		 SELECT V.*,NVL(DQBJ,0)+NVL(WDQBJ,0)-NVL(ZRBJ,0) BJCY FROM (
				SELECT CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END SFDQ,T.BELONG SRF,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYPRINCIPALAMT END) DQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYPRINCIPALAMT END) WDQBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYPRINCIPALAMT END) ZRBJ,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'pay')>0 THEN T.PAYINTEAMT END) DQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'undue')>0 THEN T.PAYINTEAMT END) WDQLX,
				SUM(CASE WHEN INSTR(T.DATASOURCE,'finance')>0 THEN T.PAYINTEAMT END) ZRLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE = '09' 
	   GROUP BY CASE WHEN INSTR(T.DATASOURCE,'month')>0 THEN '当期' ELSE '累计' END,T.BELONG) V ORDER BY V.SFDQ,V.SRF
	</select>
	
	<select id="queryDataCheckTableMenuTwelveFindAll" resultMap="DataCheckMap">
		 SELECT V.*,NVL(SYLJBJ,0)+NVL(DYBJ,0)-NVL(DYLJBJ,0) BJCY,
				NVL(SYLJLX,0)+NVL(DYLX,0)-NVL(DYLJLX,0) LXCY FROM (
				SELECT DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表') SHBD,T.BELONG BELONG,T.GUARANTEEPARTY GUARANTEEPARTY,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYPRINCIPALAMT END) SYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYPRINCIPALAMT END) DYBJ,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYPRINCIPALAMT END) DYLJBJ,
				SUM(CASE WHEN T.CHECKTYPE='12' THEN T.PAYINTEAMT END) SYLJLX,
				SUM(CASE WHEN T.CHECKTYPE='99' THEN T.PAYINTEAMT END) DYLX,
				SUM(CASE WHEN T.CHECKTYPE='02' THEN T.PAYINTEAMT END) DYLJLX
				FROM CHECK_FINANCE_RESULT T WHERE T.CHECKTYPE IN ('02','99','12') AND T.DATASOURCE IN ('pay','actualpay')
	   GROUP BY DECODE(T.DATASOURCE,'pay','到期表','actualpay','实还表'),T.BELONG,T.GUARANTEEPARTY) V ORDER BY V.SHBD,V.BELONG,V.GUARANTEEPARTY
	</select>
</mapper>
